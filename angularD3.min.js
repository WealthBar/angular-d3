(function(){angular.module("ad3",[])}).call(this),function(){angular.module("ad3").directive("d3Arc",function(){var a;return a=function(){return{x:0,y:1,innerRadius:0,labelRadius:0,transition:"cubic-in-out",transitionDuration:1e3}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k;return j=angular.extend(a(),d),g=e.getChart(),h=parseFloat(j.innerRadius),i=parseFloat(j.labelRadius),f=e.getChart().append("g").attr("class","arc"),k=function(){var a,c,g,k,l,m;return g=b.$eval(d.data),null!=g&&0!==g.length?(m=Math.min(e.innerWidth(),e.innerHeight())/2,f.attr("transform","translate("+m+","+m+")"),a=d3.svg.arc().outerRadius(m).innerRadius(m*h).startAngle(0).endAngle(function(a){return a.value/100*2*Math.PI}),k=d3.svg.arc().outerRadius(m*i).innerRadius(m*i),c=function(b){var c;return c=d3.interpolate({value:0},b),function(b){return a(c(b))}},l=f.selectAll("path").data([{value:g[j.amount]}]),l.enter().append("path").transition().ease(j.transition).duration(j.transitionDuration).attrTween("d",c),l.enter().append("text").attr("class","arc-label").attr("dy","0.35em").style("text-anchor","middle").text(g[j.label]),l.transition().ease(j.transition).duration(j.transitionDuration).attrTween("d",c)):void 0},b.$watch(d.data,k,!0),e.registerElement({redraw:k})}}})}.call(this),function(){angular.module("ad3").directive("d3Area",function(){var a;return a=function(){return{}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l;return i=angular.extend(a(),d),k=e.getScale(i.xscale||i.x),l=e.getScale(i.yscale||i.y),h=e.innerHeight(),i.vertical?(f=d3.svg.area().y(function(a){return k(a[i.x])}).x0(0).x1(function(a){return l(a[i.y])}),g=d3.svg.area().y(function(a){return k(a.x)}).x0(function(a){return l(a.y0)}).x1(function(a){return l(a.y+a.y0)})):(f=d3.svg.area().x(function(a){return k(a[i.x])}).y0(h).y1(function(a){return l(a[i.y])}),g=d3.svg.area().x(function(a){return k(a.x)}).y0(function(a){return l(a.y0)}).y1(function(a){return l(a.y+a.y0)})),j=function(){var a,c,d,h,j,k,l,m,n;return h=b.$eval(i.data),null!=h&&0!==h.length&&(null!=i.y&&(d=i.y),null!=i.columns&&(d=b.$eval(i.columns)),null!=d)?(d=d.split(",").map(function(a){return a.trim()}),1===d.length?(a=e.getChart().select("path.area"),a[0][0]||(a=e.getChart().append("path").attr("class","area")),a.datum(h).transition().duration(500).attr("d",f)):(m=function(){var a,b,c;for(c=[],a=0,b=d.length;b>a;a++)j=d[a],c.push({name:j,values:function(){var a,b,c;for(c=[],a=0,b=h.length;b>a;a++)n=h[a],c.push({x:Number(n[i.x]),y:Number(n[j])});return c}()});return c}(),k=d3.layout.stack().values(function(a){return a.values}),null!=i.offset&&k.offset(i.offset),l=k(m),c=e.getChart().selectAll(".area-stacked"),c=0===c[0].length?c.data(l).enter().append("path").attr("class",function(a){return"area area-stacked "+a.name}):c.data(l),c.transition().duration(500).attr("d",function(a){return g(a.values)}))):void 0},b.$watch(i.data,j,!0),b.$watch(i.columns,j,!0),e.registerElement({redraw:j})}}})}.call(this),function(){angular.module("ad3").directive("d3Axis",function(){var a;return a=function(){return{orientation:"bottom",ticks:"5",format:null,extent:!1}},{priority:1,restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o;return j=angular.extend(a(),d),l=function(){return"top"===j.orientation||"bottom"===j.orientation?null!=j.reverse?[e.innerWidth(),0]:[0,e.innerWidth()]:null!=j.reverse?[0,e.innerHeight()]:[e.innerHeight(),0]},o=function(){return"bottom"===j.orientation?"translate(0, "+e.innerHeight()+")":"top"===j.orientation?"translate(0, 0)":"left"===j.orientation?"translate(0, 0)":"right"===j.orientation?"translate("+e.innerWidth()+", 0)":void 0},n=d3.scale.linear(),f=d3.svg.axis().scale(n).orient(j.orientation).ticks(j.ticks),j.format&&(h=d3.format(j.format),f.tickFormat(h)),k=function(a){return"bottom"===j.orientation?a.attr("x",""+e.innerWidth()/2).attr("dy",""+e.margin.bottom).attr("style","text-anchor: middle;"):"top"===j.orientation?a.attr("x",""+e.innerWidth()/2).attr("dy",""+-e.margin.top).attr("style","text-anchor: middle;"):"left"===j.orientation?a.attr("x","-"+e.innerHeight()/2).attr("y",""+(-e.margin.left+18)).attr("style","text-anchor: middle;").attr("transform","rotate(-90)"):"right"===j.orientation?a.attr("x",""+e.innerHeight()/2).attr("dy",""+(-e.margin.right+18)).attr("style","text-anchor: middle;").attr("transform","rotate(90)"):void 0},g=e.getChart().append("g").attr("class","axis axis-"+j.orientation+" axis-"+j.name).attr("transform",o()),j.label&&(i=g.append("text").attr("class","axis-label").text(j.label)),m=function(){var a,c,e;return a=b.$eval(d.data),null!=a&&0!==a.length?(n.range(l()),i&&k(i.transition().duration(500)),e=function(){var b,d,e;for(e=[],b=0,d=a.length;d>b;b++)c=a[b],e.push(new Number(c[j.name]));return e}(),n.domain(j.extent?d3.extent(e):[0,d3.max(e)]),g.transition().duration(500).attr("transform",o()).call(f),g.selectAll("line").attr("style","fill: none; stroke-width: 2px; stroke: #303030;"),g.selectAll("path").attr("style","fill: none; stroke-width: 2px; stroke: #303030;")):void 0},b.$watch(d.data,m,!0),e.addScale(j.name,{scale:n,redraw:m})}}})}.call(this),function(){angular.module("ad3").directive("d3Bars",function(){var a;return a=function(){return{x:0,y:1,width:15}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l;return h=angular.extend(a(),d),k=e.getScale(h.xscale||h.x),l=e.getScale(h.yscale||h.y),f=e.getChart(),g=e.innerHeight(),j=h.width,i=function(){var a,c;return c=b.$eval(d.data),null!=c&&0!==c.length?(a=f.selectAll("rect.bar").data(c),a.exit().transition().duration(500).attr("y",function(){return g}).attr("height",0).remove(),a.transition().duration(500).attr("x",function(a){return k(a[h.x])-j/2}).attr("y",function(a){return l(a[h.y])}).attr("height",function(a){return g-l(a[h.y])}).attr("width",j),a.enter().append("rect").attr("class",function(a,b){return"bar bar-"+b}).attr("x",function(a){return k(a[h.x])-j/2}).attr("width",j).attr("y",g).attr("height",0).transition().duration(500).attr("y",function(a){return l(a[h.y])}).attr("height",function(a){return g-l(a[h.y])})):void 0},b.$watch(d.data,i,!0),e.registerElement({redraw:i})}}})}.call(this),function(){angular.module("ad3").directive("d3Chart",function(){return{restrict:"EA",scope:!0,controller:["$scope","$element","$attrs","$window","$timeout",function(a,b,c,d,e){var f,g,h,i,j,k;this.margin=a.$eval(c.margin)||{top:10,right:10,bottom:10,left:10},k=d3.select(b[0]).append("svg").attr("class","d3").attr("width",c.width||"100%").attr("height",c.height||"100%"),this.width=function(){return k[0][0].scrollWidth},this.height=function(){return k[0][0].scrollHeight},this.innerWidth=function(){return this.width()-this.margin.left-this.margin.right},this.innerHeight=function(){return this.height()-this.margin.top-this.margin.bottom},f=k.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.getChart=function(){return f},j={},h=[],this.addScale=function(a,b){return j[a]=b},this.getScale=function(a){return j[a].scale},this.registerElement=function(a){return h.push(a)},g=null,i=function(){return g&&e.cancel(g),g=e(function(){var a,b,c,d,e,f;for(b in j)c=j[b],c.redraw();for(f=[],d=0,e=h.length;e>d;d++)a=h[d],f.push(a.redraw());return f},200)},d.addEventListener("resize",i)}]}})}.call(this),function(){angular.module("ad3").directive("d3Data",["d3Service",function(a){return{restrict:"E",scope:!1,link:function(b,c,d){var e,f;return f=d.src,e=d.data,b[e]=a.csv(f,d.columns.split(","))}}}])}.call(this),function(){angular.module("ad3").directive("d3Line",function(){var a;return a=function(){return{x:0,y:1}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l;return i=angular.extend(a(),d),k=e.getScale(i.xscale||i.x),l=e.getScale(i.yscale||i.y),f=e.innerHeight(),g=d3.svg.line().x(function(a){return k(a[i.x])}).y(function(a){return l(a[i.y])}),h=e.getChart().append("path").attr("class","line"),j=function(){var a;return a=b.$eval(d.data),null!=a&&0!==a.length?h.datum(a).transition().duration(500).attr("d",g):void 0},b.$watch(d.data,j,!0),e.registerElement({redraw:j})}}})}.call(this),function(){angular.module("ad3").directive("d3Pie",function(){var a;return a=function(){return{x:0,y:1,innerRadius:0,labelRadius:.7,transition:"cubic-in-out",transitionDuration:1e3}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l;return j=angular.extend(a(),d),g=e.getChart(),h=parseFloat(j.innerRadius),i=parseFloat(j.labelRadius),k=d3.layout.pie().sort(null).value(function(a){return a[j.amount]}),f=e.getChart().append("g").attr("class","pie"),l=function(){var a,c,g,l,m,n,o,p,q,r;if(c=b.$eval(d.data),null!=c&&0!==c.length){for(n=Math.min(e.innerWidth(),e.innerHeight())/2,f.attr("transform","translate("+n+","+n+")"),a=d3.svg.arc().outerRadius(n).innerRadius(n*h),m=d3.svg.arc().outerRadius(n*i).innerRadius(n*i),o={},p=function(a){return o[a[j.amount]]=a[j.value]},q=0,r=c.length;r>q;q++)g=c[q],p(g);return l=f.selectAll(".pie").data(k(c)).enter().append("g"),l.attr("class",function(a,b){return"pie pie-"+b}).append("path"),l.append("text"),f.selectAll(".pie text").data(k(c)).attr("transform",function(a){return"translate("+m.centroid(a)+")"}).attr("dy","0.35em").style("text-anchor","middle").text(function(a){return o[a.value]}),f.selectAll(".pie path").data(k(c)).attr("d",a)}},b.$watch(d.data,l,!0),e.registerElement({redraw:l})}}})}.call(this),function(){angular.module("ad3").provider("d3Service",function(){var a;return a=this.defaults={},this.$get=["$cacheFactory","$rootScope",function(b,c){var d;return d=a.cache||b("d3Service"),{csv:function(a,b){var e;return(e=d.get(a))?e:(d.put(a,e=[]),d3.csv(a,function(a){var c,d,e,f;for(c={},e=0,f=b.length;f>e;e++)d=b[e],d=d.trim(),c[d]=a[d];return c},function(b,f){return null!=b?d.remove(a):(e.push.apply(e,f),c.$apply())}),e)}}}],this})}.call(this);