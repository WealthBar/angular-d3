!function(){angular.module("ad3",[])}.call(this),function(){angular.module("ad3").directive("d3Arc",function(){var a;return a=function(){return{x:0,y:1,innerRadius:0,labelRadius:0,transition:"cubic-in-out",transitionDuration:1e3,value:"value",label:"label"}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l,m;return l=angular.extend(a(),d),i=e.getChart(),j=parseFloat(l.innerRadius),k=parseFloat(l.labelRadius),h=e.getChart().append("g").attr("class","arc"),g=h.append("path"),f=h.append("text").attr("class","arc-label").attr("dy","0.35em").style("text-anchor","middle"),m=function(a){var b,c,d,i;if(null!=a&&0!==a.length)return i=Math.min(e.innerWidth(),e.innerHeight())/2,h.attr("transform","translate("+i+","+i+")"),b=d3.svg.arc().outerRadius(i).innerRadius(i*j).startAngle(0).endAngle(function(a){return 2*(a/100)*Math.PI}),c=function(a){var c;return null==this._current&&(this._current=0),c=d3.interpolate(this._current,a),this._current=a,function(a){return b(c(a))}},d=d3.svg.arc().outerRadius(i*k).innerRadius(i*k),g.datum(a[l.value]).transition().ease(l.transition).duration(l.transitionDuration).attrTween("d",c),f.text(a[l.label])},e.registerElement({redraw:m})}}})}.call(this),function(){angular.module("ad3").directive("d3Area",function(){var a;return a=function(){return{}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l;return i=angular.extend(a(),d),k=e.getScale(i.xscale||i.x),l=e.getScale(i.yscale||i.y),h=e.innerHeight(),i.vertical?(f=d3.svg.area().y(function(a){return k(a[i.x])}).x0(0).x1(function(a){return l(a[i.y])}),g=d3.svg.area().y(function(a){return k(a.x)}).x0(function(a){return l(a.y0)}).x1(function(a){return l(a.y+a.y0)})):(f=d3.svg.area().x(function(a){return k(a[i.x])}).y0(h).y1(function(a){return l(a[i.y])}),g=d3.svg.area().x(function(a){return k(a.x)}).y0(function(a){return l(a.y0)}).y1(function(a){return l(a.y+a.y0)})),j=function(a){var c,d,h,j,k,l,m,n;if(null!=a&&0!==a.length&&(null!=i.y&&(h=i.y),null!=i.columns&&(h=b.$eval(i.columns)),null!=h))return h=h.split(",").map(function(a){return a.trim()}),1===h.length?(c=e.getChart().select("path.area"),c[0][0]||(c=e.getChart().append("path").attr("class","area")),c.datum(a).transition().duration(500).attr("d",f)):(m=function(){var b,c,d;for(d=[],b=0,c=h.length;c>b;b++)j=h[b],d.push({name:j,values:function(){var b,c,d;for(d=[],b=0,c=a.length;c>b;b++)n=a[b],d.push({x:Number(n[i.x]),y:Number(n[j])});return d}()});return d}(),k=d3.layout.stack().values(function(a){return a.values}),null!=i.offset&&k.offset(i.offset),l=k(m),d=e.getChart().selectAll(".area-stacked"),d=0===d[0].length?d.data(l).enter().append("path").attr("class",function(a){return"area area-stacked "+a.name}):d.data(l),d.transition().duration(500).attr("d",function(a){return g(a.values)}))},null!=i.columns&&b.$watch(i.columns,e.redraw(),!0),e.registerElement({redraw:j})}}})}.call(this),function(){angular.module("ad3").directive("d3Axis",function(){var a;return a=function(){return{orientation:"bottom",ticks:"5",extent:!1}},{priority:1,restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o;return j=angular.extend(a(),d),l=function(){return"top"===j.orientation||"bottom"===j.orientation?null!=j.reverse?[e.innerWidth(),0]:[0,e.innerWidth()]:null!=j.reverse?[0,e.innerHeight()]:[e.innerHeight(),0]},o=function(){return"bottom"===j.orientation?"translate(0, "+e.innerHeight()+")":"top"===j.orientation?"translate(0, 0)":"left"===j.orientation?"translate(0, 0)":"right"===j.orientation?"translate("+e.innerWidth()+", 0)":void 0},n=d3.scale.linear(),f=d3.svg.axis().scale(n).orient(j.orientation).ticks(j.ticks),null!=j.format&&(h=d3.format(j.format),f.tickFormat(h)),k=function(a){return"bottom"===j.orientation?a.attr("x",""+e.innerWidth()/2).attr("dy",""+e.margin.bottom).attr("style","text-anchor: middle;"):"top"===j.orientation?a.attr("x",""+e.innerWidth()/2).attr("dy",""+-e.margin.top).attr("style","text-anchor: middle;"):"left"===j.orientation?a.attr("x","-"+e.innerHeight()/2).attr("y",""+(-e.margin.left+18)).attr("style","text-anchor: middle;").attr("transform","rotate(-90)"):"right"===j.orientation?a.attr("x",""+e.innerHeight()/2).attr("dy",""+(-e.margin.right+18)).attr("style","text-anchor: middle;").attr("transform","rotate(90)"):void 0},g=e.getChart().append("g").attr("class","axis axis-"+j.orientation+" axis-"+j.name).attr("transform",o()),j.label&&(i=g.append("text").attr("class","axis-label").text(j.label)),m=function(a){var c,d,e,h;if(null!=a&&0!==a.length)return n.range(l()),i&&k(i.transition().duration(500)),j.filter?(e=b.$eval(""+j.filter+"(data)",{data:a}),d=function(){var a,b,c;for(c=[],a=0,b=e.length;b>a;a++)h=e[a],c.push(new Number(h));return c}()):d=function(){var b,d,e;for(e=[],b=0,d=a.length;d>b;b++)c=a[b],e.push(new Number(c[j.name]));return e}(),j.extent?n.domain(d3.extent(d)):n.domain([0,d3.max(d)]),g.transition().duration(500).attr("transform",o()).call(f),g.selectAll("line").attr("style","fill: none; stroke-width: 2px; stroke: #303030;"),g.selectAll("path").attr("style","fill: none; stroke-width: 2px; stroke: #303030;")},e.addScale(j.name,{scale:n,redraw:m})}}})}.call(this),function(){angular.module("ad3").directive("d3Bars",function(){var a;return a=function(){return{x:0,y:1,width:15}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l;return h=angular.extend(a(),d),k=e.getScale(h.xscale||h.x),l=e.getScale(h.yscale||h.y),f=e.getChart(),g=e.innerHeight(),j=h.width,i=function(a){var b;if(null!=a&&0!==a.length)return b=f.selectAll("rect.bar").data(a),b.exit().transition().duration(500).attr("y",function(){return g}).attr("height",0).remove(),b.transition().duration(500).attr("x",function(a){return k(a[h.x])-j/2}).attr("y",function(a){return l(a[h.y])}).attr("height",function(a){return g-l(a[h.y])}).attr("width",j),b.enter().append("rect").attr("class",function(a,b){return"bar bar-"+b}).attr("x",function(a){return k(a[h.x])-j/2}).attr("width",j).attr("y",g).attr("height",0).transition().duration(500).attr("y",function(a){return l(a[h.y])}).attr("height",function(a){return g-l(a[h.y])})},e.registerElement({redraw:i})}}})}.call(this),function(){angular.module("ad3").directive("d3Chart",function(){return{restrict:"EA",scope:!0,controller:["$scope","$element","$attrs","$window","$timeout",function(a,b,c,d,e){var f,g,h,i,j,k,l=this;j=a.scales={},i=a.elements=[],f=a.binding=c.data,this.margin=a.$eval(c.margin)||{top:10,right:10,bottom:10,left:10},k=d3.select(b[0]).append("svg").attr("class","d3").attr("width","100%").attr("height","100%"),this.width=function(){return b[0].offsetWidth},this.height=function(){return b[0].offsetHeight},this.innerWidth=function(){return l.width()-l.margin.left-l.margin.right},this.innerHeight=function(){return l.height()-l.margin.top-l.margin.bottom},g=k.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.getChart=function(){return g},this.addScale=function(a,b){return j[a]=b},this.getScale=function(a){return j[a].scale},this.registerElement=function(a){return i.push(a)},h=null,this.redraw=function(){return h?void 0:h=e(function(){var b,c,d,e,g,k,l;h=null,b=a.$eval(f);for(d in j)e=j[d],e.redraw(b);for(l=[],g=0,k=i.length;k>g;g++)c=i[g],l.push(c.redraw(b));return l},c.updateInterval||200)},d.addEventListener("resize",this.redraw),a.$watch(f,this.redraw,!0)}]}})}.call(this),function(){angular.module("ad3").directive("d3Data",["d3Service",function(a){return{restrict:"E",scope:!1,link:function(b,c,d){var e,f,g,h;return h=d.src,f=d.data,d.accessor&&(e=b.$eval(d.accessor)),d.callback&&(g=b.$eval(d.callback)),a.csv(h,e,g).then(function(a){return b[f]=a},function(){throw"Error loading CSV via D3"})}}}])}.call(this),function(){angular.module("ad3").directive("d3Line",function(){var a;return a=function(){return{x:0,y:1}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l;return i=angular.extend(a(),d),k=e.getScale(i.xscale||i.x),l=e.getScale(i.yscale||i.y),f=e.innerHeight(),g=d3.svg.line().x(function(a){return k(a[i.x])}).y(function(a){return l(a[i.y])}),h=e.getChart().append("path").attr("class","line line-"+(i.name||i.y)).style("fill","none").style("stroke",i.stroke),j=function(a){return null!=a&&0!==a.length?h.datum(a).transition().duration(500).attr("d",g):void 0},e.registerElement({redraw:j})}}})}.call(this),function(){angular.module("ad3").directive("d3Pie",function(){var a;return a=function(){return{x:0,y:1,innerRadius:0,labelRadius:.7,transition:"cubic-in-out",transitionDuration:800,minOffset:12,value:"value"}},{restrict:"E",require:"^d3Chart",link:function(b,c,d,e){var f,g,h,i,j,k,l,m,n;return k=angular.extend(a(),d),g=e.getChart(),i=parseFloat(k.innerRadius),j=parseFloat(k.labelRadius),d.colors&&(h=function(){switch(d.colors){case"category20":return d3.scale.category20();case"category20b":return d3.scale.category20b();case"category20c":return d3.scale.category20c()}}()),l=d3.layout.pie().sort(null).value(function(a){return a[k.value]}),f=e.getChart().append("g").attr("class","pie"),n=null,m=function(a){var b,c,g,m,n,o,p,q,r;if(null!=a&&0!==a.length)return q=Math.min(e.innerWidth(),e.innerHeight())/2,f.attr("transform","translate("+q+","+q+")"),b=d3.svg.arc().outerRadius(q).innerRadius(q*i),c=function(a){var c;return c=d3.interpolate(this._current,a),this._current=c(0),function(a){return b(c(a))}},n=d3.svg.arc().outerRadius(q*j).innerRadius(q*j),r=f.selectAll(".pie").data(l(a)),r.enter().append("path").attr("class",function(a,b){return"pie pie-"+b}).attr("d",b).each(function(a){return this._current=a}),d.colors&&r.style("fill",function(a,b){return h?h(b):a[d.color]}),r.exit().remove(),r.transition().ease(k.transition).duration(k.transitionDuration).attrTween("d",c),k.label?(p=null,o=+k.minOffset,g=function(a){var b,c,d,e,f,g,h,i,l;return h=n.centroid(a),k.avoidCollisions&&(i=[h[0],h[1]],this._position&&(i[0]-=this._position[0],i[1]-=this._position[1]),l=_.transform(this.getBoundingClientRect(),function(a,b,c){switch(c){case"left":return a[c]=b-o+i[0];case"top":return a[c]=b-o+i[1];case"right":return a[c]=b+o+i[0];case"bottom":return a[c]=b+o+i[1]}}),!p||l.right<p.left||l.left>p.right||l.bottom<p.top||l.top>p.bottom||(d=l.left+(l.right-l.left)/2,e=l.top+(l.bottom-l.top)/2,b=p.left+(p.right-p.left)/2,c=p.top+(p.bottom-p.top)/2,f=Math.sqrt(Math.pow(d-b,2)+Math.pow(e-c,2))/2,g=d3.svg.arc().outerRadius(q*j+f).innerRadius(q*j+f),h=g.centroid(a)),this._position=h,p=l),"translate("+h+")"},m=f.selectAll("text").data(l(a)),m.enter().append("text").style("text-anchor","middle").attr("class",function(a,b){return"pie-label pie-label-"+b}),m.exit().remove(),m.text(function(b,c){return a[c][k.label]}),m.transition().ease(k.transition).duration(k.transitionDuration).attr("transform",g)):void 0},e.registerElement({redraw:m})}}})}.call(this),function(){angular.module("ad3").provider("d3Service",function(){var a;return a=this.defaults={},this.$get=["$cacheFactory","$rootScope","$q",function(b,c,d){var e;return e=a.cache||b("d3Service"),{csv:function(a,b,f){var g,h;return h=d.defer(),g=e.get(a),g&&(f&&f(rows),h.resolve(g)),d3.csv(a,b,function(b){return c.$apply(function(){return f&&f(b),b?(e.put(a,b),h.resolve(b)):h.reject()})}),h.promise}}}],this})}.call(this);